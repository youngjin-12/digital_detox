<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ë°°ê²½ ì‚¬ìš´ë“œ í…ŒìŠ¤íŠ¸</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: #050812;
        color: #f5f5f5;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .wrap {
        padding: 20px 24px;
        border-radius: 16px;
        background: radial-gradient(
          circle at top,
          rgba(255, 255, 255, 0.04) 0,
          #090c15 55%
        );
        border: 1px solid rgba(255, 255, 255, 0.12);
        box-shadow: 0 18px 40px rgba(0, 0, 0, 0.6);
        max-width: 420px;
        text-align: center;
      }
      h1 {
        font-size: 1.2rem;
        margin-bottom: 8px;
      }
      p {
        font-size: 0.9rem;
        opacity: 0.8;
        margin-bottom: 14px;
      }
      .sound-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: center;
        margin-top: 6px;
      }
      .sound-btn {
        padding: 6px 12px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.25);
        background: rgba(255, 255, 255, 0.02);
        color: #f5f5f5;
        font-size: 0.9rem;
        cursor: pointer;
        transition: background 0.12s ease, border 0.12s ease,
          transform 0.05s ease;
      }
      .sound-btn:hover {
        background: rgba(255, 255, 255, 0.06);
        transform: translateY(-1px);
      }
      .sound-btn.active {
        border-color: #ffb347;
        background: rgba(255, 179, 71, 0.18);
      }
      .hint {
        margin-top: 10px;
        font-size: 0.8rem;
        opacity: 0.7;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1>ë°°ê²½ ì‚¬ìš´ë“œ í…ŒìŠ¤íŠ¸</h1>
      <p>ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ ë¶ˆë© / ë¹—ì†Œë¦¬ / ìˆ²ì†Œë¦¬ ëŠë‚Œì„ ë“¤ì–´ë³´ì„¸ìš”.</p>

      <div class="sound-buttons">
        <button class="sound-btn" data-sound="none">ë„ê¸°</button>
        <button class="sound-btn" data-sound="fire">ğŸ”¥ ë¶ˆë©</button>
        <button class="sound-btn" data-sound="rain">ğŸŒ§ ë¹—ì†Œë¦¬</button>
        <button class="sound-btn" data-sound="forest">ğŸŒ² ìˆ²ì†Œë¦¬</button>
      </div>

      <div class="hint">
        PC ë¸Œë¼ìš°ì €ì—ì„œ í…ŒìŠ¤íŠ¸ ì¶”ì²œ (ë³¼ë¥¨ ì¡°ê¸ˆë§Œ ì˜¬ë¦¬ê³  ë“¤ì–´ë´).
      </div>
    </div>

    <script>
      // ======================
      // ë°°ê²½ ì‚¬ìš´ë“œ ì»¨íŠ¸ë¡¤ (Web Audioë¡œ ìƒì„±)
      // ======================
      const soundButtons = document.querySelectorAll(".sound-btn");

      let audioCtx = null;
      let noiseBuffer = null;
      let currentSource = null;
      let currentFilter = null;
      let currentGain = null;
      let currentSoundType = "none";

      function updateSoundButtonState(type) {
        soundButtons.forEach((btn) => {
          btn.classList.toggle("active", btn.dataset.sound === type);
        });
      }

      // 2ì´ˆì§œë¦¬ í™”ì´íŠ¸ ë…¸ì´ì¦ˆ ë²„í¼ ìƒì„±
      function getNoiseBuffer() {
        if (!audioCtx) {
          audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }
        if (noiseBuffer) return noiseBuffer;

        const duration = 2;
        const sampleRate = audioCtx.sampleRate;
        const buffer = audioCtx.createBuffer(
          1,
          sampleRate * duration,
          sampleRate
        );
        const data = buffer.getChannelData(0);

        for (let i = 0; i < data.length; i++) {
          data[i] = Math.random() * 2 - 1; // -1 ~ 1
        }

        noiseBuffer = buffer;
        return noiseBuffer;
      }

      function stopCurrentSound() {
        if (currentSource) {
          try {
            currentSource.stop();
          } catch (e) {}
          currentSource.disconnect();
        }
        if (currentFilter) currentFilter.disconnect();
        if (currentGain) currentGain.disconnect();

        currentSource = null;
        currentFilter = null;
        currentGain = null;
        currentSoundType = "none";
      }

      function playBackgroundNoise(type) {
        if (!audioCtx) {
          audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }

        stopCurrentSound();
        updateSoundButtonState(type);

        if (type === "none") return;

        const buffer = getNoiseBuffer();
        const source = audioCtx.createBufferSource();
        source.buffer = buffer;
        source.loop = true;

        const filter = audioCtx.createBiquadFilter();
        const gain = audioCtx.createGain();

        if (type === "fire") {
          filter.type = "bandpass";
          filter.frequency.value = 1000;
          filter.Q.value = 1.0;
          gain.gain.value = 0.18;
        } else if (type === "rain") {
          filter.type = "highpass";
          filter.frequency.value = 700;
          filter.Q.value = 0.7;
          gain.gain.value = 0.22;
        } else if (type === "forest") {
          filter.type = "bandpass";
          filter.frequency.value = 400;
          filter.Q.value = 0.9;
          gain.gain.value = 0.16;
        }

        source.connect(filter);
        filter.connect(gain);
        gain.connect(audioCtx.destination);

        source.start();

        currentSource = source;
        currentFilter = filter;
        currentGain = gain;
        currentSoundType = type;
      }

      soundButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const type = btn.dataset.sound;
          if (type === currentSoundType) {
            // ê°™ì€ ë²„íŠ¼ ë‹¤ì‹œ ëˆ„ë¥´ë©´ ë„ê¸°
            playBackgroundNoise("none");
          } else {
            playBackgroundNoise(type);
          }
        });
      });
    </script>
  </body>
</html>
